{
  "sequence": [
    {
      "step": 1,
      "description": "CaptureFaceData - Захват фото",
      "method": "POST",
      "url": "https://192.168.1.67/ISAPI/AccessControl/CaptureFaceData",
      "timestamp": 1765110877792,
      "statusCode": 200,
      "note": "Захват фото с терминала"
    },
    {
      "step": 2,
      "description": "Get token - Получение токена",
      "method": "GET",
      "url": "https://192.168.1.67/ISAPI/Security/token?format=json",
      "timestamp": 1765110887405,
      "statusCode": 200,
      "note": "Токен для UserInfo/Record"
    },
    {
      "step": 3,
      "description": "Get photo - Получение захваченного фото",
      "method": "GET",
      "url": "https://192.168.1.67/LOCALS/pic/web_face_enrollpic.jpg@WEB000000000172?token=NWz4wQUnfSCVQkbyBWr1SsHj9AxgwOWC",
      "timestamp": 1765110887533,
      "statusCode": 200,
      "note": "Скачивание фото с терминала"
    },
    {
      "step": 4,
      "description": "UserInfo/Record - Создание пользователя с фото (multipart)",
      "method": "POST",
      "url": "https://192.168.1.67/ISAPI/AccessControl/UserInfo/Record?format=json&security=1&iv=72b5bf78a4e2529cff80536a823d95c9",
      "timestamp": 1765110890149,
      "statusCode": 200,
      "note": "КРИТИЧЕСКИ ВАЖНО: Используется security=1&iv=... (initialization vector)"
    },
    {
      "step": 5,
      "description": "Get token for FDSetUp - Получение токена для FDSetUp",
      "method": "GET",
      "url": "https://192.168.1.67/ISAPI/Security/token?format=json",
      "timestamp": 1765110890521,
      "statusCode": 200,
      "note": "Токен для FDSetUp"
    },
    {
      "step": 6,
      "description": "FDSetUp - Настройка FDLib",
      "method": "PUT",
      "url": "https://192.168.1.67/ISAPI/Intelligent/FDLib/FDSetUp?format=json&token=eN57BR53f225WP3kJJZveiHkLd04w2ot",
      "timestamp": 1765110890627,
      "statusCode": 200,
      "note": "КРИТИЧЕСКИ ВАЖНО: Обязательный вызов после создания пользователя с фото"
    }
  ],
  "key_findings": {
    "security_parameter": {
      "name": "security",
      "value": "1",
      "note": "Обязательный параметр в UserInfo/Record"
    },
    "iv_parameter": {
      "name": "iv",
      "value": "72b5bf78a4e2529cff80536a823d95c9",
      "note": "Initialization vector - 32 символа hex (128 бит). Нужно понять, как генерируется."
    },
    "fdsetup_required": {
      "note": "FDSetUp ОБЯЗАТЕЛЬНО вызывается после UserInfo/Record с токеном в URL параметре"
    },
    "timing": {
      "capture_to_photo": "~1 секунда",
      "photo_to_userinfo": "~2.6 секунды",
      "userinfo_to_fdsetup": "~0.5 секунды"
    }
  },
  "console_messages": {
    "type": "debug",
    "messages": [
      "Uncaught (in promise) #<XMLHttpRequest> - не критично, просто предупреждения",
      "ResizeObserver loop completed - не критично, UI предупреждение"
    ]
  }
}

