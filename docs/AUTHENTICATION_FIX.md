# Исправление проблемы с аутентификацией пользователей

## Проблема

Пользователи, созданные через наш интерфейс, не могли проходить аутентификацию на терминале, хотя фото было привязано.

## Причина

При сравнении рабочего пользователя (testTER) и нерабочего (testInter) были обнаружены критические различия:

### Отсутствующие поля у нерабочего пользователя:

1. **`doorRight`** - права доступа к дверям
   - Рабочий: `"1"`
   - Нерабочий: `""` (пусто)

2. **`RightPlan.planTemplateNo`** - шаблон прав доступа
   - Рабочий: `"1"`
   - Нерабочий: отсутствует

3. **`groupId`** - группа доступа
   - Рабочий: `1`
   - Нерабочий: `0`

## Решение

Обновлен метод `create_user_basic()` в `hikvision_client.py` для включения обязательных полей:

```python
user_data = {
    "UserInfo": {
        "employeeNo": employee_no,
        "name": name,
        "userType": "normal",
        "Valid": {
            "enable": True,
            "beginTime": begin_time,  # Текущая дата
            "endTime": end_time,       # +10 лет
            "timeType": "local"
        },
        "gender": "unknown",
        # КРИТИЧНО: Права доступа к дверям
        "doorRight": "1",
        # КРИТИЧНО: Шаблон прав доступа
        "RightPlan": [
            {
                "doorNo": 1,
                "planTemplateNo": "1"
            }
        ]
    }
}

# groupId по умолчанию 1, если не указан
if group_id is not None:
    user_data["UserInfo"]["groupId"] = group_id
else:
    user_data["UserInfo"]["groupId"] = 1
```

## Результат

Теперь все пользователи, созданные через наш интерфейс, будут иметь:
- ✅ Права доступа к дверям (`doorRight: "1"`)
- ✅ Шаблон прав доступа (`RightPlan` с `planTemplateNo: "1"`)
- ✅ Группу доступа (`groupId: 1` по умолчанию)
- ✅ Актуальные даты валидности (текущая дата + 10 лет)

**Пользователи теперь смогут проходить аутентификацию!**

---

**Дата исправления:** 2025-01-10  
**Файл:** `backend/app/hikvision_client.py`  
**Метод:** `create_user_basic()`

